# Road Accident Risk Assessment Model
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)  

## Описание проекта

Проект по разработке системы оценки риска ДТП для каршеринговой компании. Модель предсказывает вероятность аварии на основе исторических данных о дорожных происшествиях, что позволяет предупреждать водителей о потенциальных опасностях на маршруте.

## Цель проекта

Создать модель машинного обучения, способную оценивать риск ДТП по выбранному маршруту движения в реальном времени. Система анализирует различные факторы дорожной обстановки и выдает предупреждения при высоком уровне риска.

## Данные

Проект использует базу данных дорожных происшествий, содержащую три основные таблицы:

- **collisions** - общая информация о ДТП (время, место, погодные условия)
- **parties** - данные об участниках аварии
- **vehicles** - информация о транспортных средствах

## Ключевые особенности

### Аналитические функции (`utils.py`)

Проект включает набор специализированных функций для анализа данных:

- **`extended_describe()`** - расширенное статистическое описание данных с дополнительными метриками
- **`plot_distribution_with_boxplot()`** - визуализация распределений с разделением по категориям
- **`plot_violin_combinations()`** - анализ комбинаций числовых и категориальных признаков
- **`plot_categorical_distributions()`** - исследование категориальных признаков
- **`phik_correlation_matrix()`** - анализ корреляций с использованием φK коэффициента
- **`vif()`** - оценка мультиколлинеарности через VIF
- **`FeatureUnionWithCatBoost`** - кастомный трансформер для объединения различных методов предобработки
- **`main()`** - функция обучения моделей с оптимизацией гиперпараметров

### Модели машинного обучения

В проекте реализовано сравнение трех типов моделей:
- Logistic Regression
- Decision Tree Classifier  
- CatBoost Classifier

## Технический стек

### Data Analysis & ML
- **Python** - основной язык программирования
- **Pandas** - обработка и анализ данных
- **NumPy** - численные вычисления
- **Scikit-learn** - машинное обучение и предобработка
- **CatBoost** - градиентный бустинг
- **Category Encoders** - кодирование категориальных признаков

### Data Visualization
- **Matplotlib** - построение графиков
- **Seaborn** - статистическая визуализация
- **Missingno** - анализ пропущенных значений

### Statistics & Analysis
- **SciPy** - статистический анализ
- **Statsmodels** - статистические тесты и VIF анализ
- **Phik** - корреляционный анализ

### Database & Engineering
- **SQLAlchemy** - работа с базами данных
- **PostgreSQL** - система управления базами данных

### Utilities
- **IPython** - интерактивные возможности Jupyter
- **Typing** - аннотации типов для лучшей читаемости кода

## Результаты

Лучшая модель - **CatBoostClassifier** показывает:
- F1-score: 0.62
- Важнейшие факторы: стоимость страховки, тип транспортного средства, географическое расположение
- Умеренная эффективность классификации

## Ключевые выводы

1. **Возможность создания системы** - умеренное качество модели указывает на возможность создания базовой системы оценки рисков
2. **Критические факторы** - стоимость страховки, тип автомобиля и локация наиболее значимы для предсказания
3. **Необходимые улучшения** - требуются дополнительные данные для повышения точности модели

## Структура проекта

```
Road-Accident-Risk-Assessment-Model/
│
├── notebooks/
│   ├── road_accident_risk_assessment_model.ipynb  # Основная тетрадка проекта
│   └── utils.py                                   # Вспомогательные функции
│
├── .gitignore
├── LICENSE
├── README.md
└── requirements.txt
```

Проект демонстрирует полный цикл разработки ML-решения: от анализа данных и feature engineering до обучения моделей и оценки их эффективности.
